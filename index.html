<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8" />
<title>Valentine Bubble Shooter</title>
<style>
body{
  margin:0;
  font-family:'Comic Sans MS',cursive;
  background:linear-gradient(#ff9bb3,#ff4d6d);
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}.background-hearts span{ position:absolute; color:rgba(255,255,255,0.2); animation:float 9s infinite ease-in-out; }

@keyframes float{ 0%{transform:translateY(100vh);opacity:0} 50%{opacity:.5} 100%{transform:translateY(-10vh);opacity:0} }

canvas{ background:transparent; }

.menu{ position:absolute; text-align:center; }

button{ background:#ff2f68; border:none; color:white; padding:14px 26px; font-size:18px; border-radius:25px; cursor:pointer; }

.message{ position:absolute; text-align:center; font-size:28px; color:#b3003c; background:rgba(255,255,255,.95); padding:25px 35px; border-radius:22px; display:none; } </style>

</head>
<body><div class="background-hearts"></div><div class="menu" id="startMenu">
  <button onclick="startGame()">ğŸ’˜ start game ğŸ’˜</button>
</div><canvas id="game" width="360" height="520" style="display:none"></canvas>

<div class="menu" id="restartMenu" style="display:none">
  <div class="message">ğŸ’– Will you be my Valentine Sweetiepie? ğŸ’–</div><br>
  <button onclick="restartGame()">ğŸ” restart</button>
</div><script>
const canvas=document.getElementById('game');
const ctx=canvas.getContext('2d');

const bubbles=['â¤ï¸','ğŸ«','ğŸŒ¹','ğŸ§¸'];
const rows=7,cols=7,radius=18;
let grid=[],particles=[];
let playing=false;

let shooter={x:canvas.width/2,y:canvas.height-40,bubble:rand(),dx:0,dy:0,moving:false};

function rand(){return bubbles[Math.floor(Math.random()*bubbles.length)]}

function initGrid(){
  grid=[];
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      const x=canvas.width/2+(c-cols/2)*40;
      const y=110+r*38;
      grid.push({x,y,bubble:rand(),active:true})
    }
  }
}

function drawHeartBox(){
  ctx.lineWidth=10;
  ctx.strokeStyle='#ff003c';
  ctx.beginPath();
  ctx.moveTo(180,160);
  ctx.bezierCurveTo(120,60,0,160,180,360);
  ctx.bezierCurveTo(360,160,240,60,180,160);
  ctx.stroke();

  ctx.fillStyle='rgba(255,255,255,0.85)';
  ctx.beginPath();
  ctx.moveTo(180,160);
  ctx.bezierCurveTo(130,80,40,160,180,330);
  ctx.bezierCurveTo(320,160,230,80,180,160);
  ctx.fill();
}

function drawGrid(){
  grid.forEach(b=>{
    if(!b.active)return;
    ctx.beginPath();
    ctx.arc(b.x,b.y,radius,0,Math.PI*2);
    ctx.fillStyle='#fff';
    ctx.fill();
    ctx.font='18px serif';
    ctx.textAlign='center';
    ctx.textBaseline='middle';
    ctx.fillText(b.bubble,b.x,b.y+1);
  })
}

function drawShooter(){
  ctx.font='26px serif';
  ctx.textAlign='center';
  ctx.fillText('ğŸ¹',shooter.x,shooter.y+8);
  ctx.beginPath();
  ctx.arc(shooter.x,shooter.y-22,radius,0,Math.PI*2);
  ctx.fillStyle='#fff';
  ctx.fill();
  ctx.font='18px serif';
  ctx.fillText(shooter.bubble,shooter.x,shooter.y-22);
}

function flood(start){
  const stack=[start],match=[start];
  start.visited=true;
  while(stack.length){
    const b=stack.pop();
    grid.forEach(n=>{
      if(!n.active||n.visited||n.bubble!==start.bubble)return;
      if(Math.hypot(n.x-b.x,n.y-b.y)<radius*2.2){
        n.visited=true;
        stack.push(n);
        match.push(n);
      }
    })
  }
  grid.forEach(b=>b.visited=false);
  return match;
}

function explode(x,y){for(let i=0;i<12;i++)particles.push({x,y,dx:(Math.random()-.5)*5,dy:(Math.random()-.5)*5,l:30})}

function drawParticles(){particles.forEach(p=>{ctx.fillStyle='rgba(255,77,109,.8)';ctx.beginPath();ctx.arc(p.x,p.y,4,0,Math.PI*2);ctx.fill();p.x+=p.dx;p.y+=p.dy;p.l--});particles=particles.filter(p=>p.l>0)}

function updateShooter(){
  if(!shooter.moving)return;
  shooter.x+=shooter.dx;
  shooter.y+=shooter.dy;

  grid.forEach(b=>{
    if(!b.active)return;
    if(Math.hypot(b.x-shooter.x,b.y-shooter.y)<radius*2){
      shooter.moving=false;
      const placed={x:shooter.x,y:shooter.y,bubble:shooter.bubble,active:true};
      grid.push(placed);
      const match=flood(placed);
      if(match.length>=3){match.forEach(m=>{m.active=false;explode(m.x,m.y)})}
      resetShooter();
      checkWin();
    }
  })

  if(shooter.y<80){shooter.moving=false;resetShooter()}
}

function resetShooter(){shooter.x=canvas.width/2;shooter.y=canvas.height-40;shooter.bubble=rand()}

function checkWin(){if(grid.every(b=>!b.active)){playing=false;document.getElementById('restartMenu').style.display='block'}}

canvas.addEventListener('click',e=>{
  if(!playing||shooter.moving)return;
  const r=canvas.getBoundingClientRect();
  const x=e.clientX-r.left,y=e.clientY-r.top;
  const a=Math.atan2(y-shooter.y,x-shooter.x);
  shooter.dx=Math.cos(a)*7;shooter.dy=Math.sin(a)*7;shooter.moving=true
})

function loop(){
  if(!playing)return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawHeartBox();
  drawGrid();
  drawShooter();
  updateShooter();
  drawParticles();
  requestAnimationFrame(loop);
}

function startGame(){document.getElementById('startMenu').style.display='none';document.getElementById('restartMenu').style.display='none';canvas.style.display='block';initGrid();playing=true;loop()}
function restartGame(){startGame()}

function spawnHearts(){const c=document.querySelector('.background-hearts');for(let i=0;i<30;i++){const h=document.createElement('span');h.textContent='â¤';h.style.left=Math.random()*100+'%';h.style.animationDelay=Math.random()*9+'s';h.style.fontSize=10+Math.random()*18+'px';c.appendChild(h)}}
spawnHearts();
</script></body>
</html>
